const link=document.querySelector(".link-write-us"),popup=document.querySelector(".modal-write-us"),close=popup.querySelector(".modal-close"),form=popup.querySelector("form"),name=form.querySelector("[name=name]"),email=form.querySelector("[name=email]"),message=form.querySelector("textarea");let isStorageSupport=!0,storage_name="",storage_email="";try{storage_name=localStorage.getItem("name"),storage_email=localStorage.getItem("email")}catch(e){isStorageSupport=!1}link.addEventListener("click",function(e){e.preventDefault(),popup.classList.remove("modal--error"),popup.classList.add("modal--show");let a=!1;storage_name?name.value=storage_name:(name.focus(),a=!0),storage_email?email.value=storage_email:a||(email.focus(),a=!0),a||message.focus()}),close.addEventListener("click",function(e){e.preventDefault(),popup.classList.remove("modal--show")}),window.addEventListener("keydown",function(e){27===e.keyCode&&popup.classList.contains("modal--show")&&(e.preventDefault(),popup.classList.remove("modal--show"))}),name.addEventListener("focus",function(e){name.classList.remove("field-invalid")}),email.addEventListener("focus",function(e){email.classList.remove("field-invalid")}),message.addEventListener("focus",function(e){message.classList.remove("field-invalid")}),form.addEventListener("submit",function(e){popup.classList.remove("modal--error"),popup.offsetWidth=popup.offsetWidth,name.value&&email.value&&message.value?isStorageSupport&&(localStorage.setItem("name",name.value),localStorage.setItem("email",email.value)):(e.preventDefault(),name.value||name.classList.add("field-invalid"),email.value||email.classList.add("field-invalid"),message.value||message.classList.add("field-invalid"),console.log("Нужно заполнить все поля формы"),popup.classList.add("modal--error"))});